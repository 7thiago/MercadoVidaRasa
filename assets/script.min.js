document.addEventListener("DOMContentLoaded",(function(){const e=[{username:"Admin",password:"123",role:"admin"},{username:"Thiago",password:"123",role:"user"}];function t(){localStorage.setItem("catalogo",JSON.stringify(o)),localStorage.setItem("carrinho",JSON.stringify(i)),localStorage.setItem("loggedUser",JSON.stringify(d))}function n(e){return document.getElementById(e)}let o=JSON.parse(localStorage.getItem("catalogo"))||[],i=JSON.parse(localStorage.getItem("carrinho"))||[],d=JSON.parse(localStorage.getItem("loggedUser"))||null;function r(){const e=document.getElementById("products-grid");e&&o.forEach((t=>{const n=document.createElement("a");n.onclick=()=>{c(t.id)},n.className="product-item",n.id=t.id,n.innerHTML=`<div class="add-cart">\n                        <p>Adicionar ao carrinho</p>\n                    </div>\n                    <div class="photo">\n                        <img src="${t.imagem}" alt="${t.nome}">\n                    </div>\n                    <div class="info">\n                        <div class="product-name">${t.nome}</div>\n                        <div class="product-price">R$${t.preco.toFixed(2)}</div>\n                    </div>`,e.appendChild(n)}))}function a(){const e=document.getElementById("cartlist");if(e){let o=0;i.forEach(((t,n)=>{const i=document.createElement("div");i.className="cartitem",i.innerHTML+=`<span>${t.nome} - R$ ${t.preco.toFixed(2)}</span>`,i.innerHTML+=`<button id="removePro${n}" onclick="removerCarrinho(${t.id})" class="deleteCart">Remover</button>`,e.appendChild(i),o+=t.preco})),e.innerHTML+='<div class="division"></div>',e.innerHTML+=`<div class="center">\n                                            <label for="nameClient">Nome:</label>\n                                            <input type="text" id="nameClient" required/>\n                                            <label for="cpf">CPF:</label>\n                                            <input type="number" id="cpf" required/>\n                                            <label for="endereco">Endereço:</label>\n                                            <input type="text" id="endereco" required/>\n                                        </div>\n                                        <div class="carttotal">\n                                            <div class="totaltext">\n                                                <h2>Total das compras: R$ ${o.toFixed(2)}</h2>\n                                            </div>\n                                            <div class="buycart">\n                                                <button id="payment">Finalizar compra</button>\n                                            </div>\n                                        </div>`,document.getElementById("payment")?.addEventListener("click",(function(){let o=function(){let e=[];return n("nameClient")&&""===n("nameClient").value&&e.push("nome"),n("cpf")&&""===n("cpf").value&&e.push("cpf"),n("endereco")&&""===n("endereco").value&&e.push("endereço"),e}(),d="";o.forEach((e=>{d+=`${e}, `})),o.length>0?Swal.fire({title:"Campos inválidos!",text:`Por favor, verifique os seguintes campos: ${d}`,icon:"error"}).then((e=>{window.location.href=""})):(e.innerHTML="",Swal.fire({title:"Compra finalizada!",text:"Sua compra foi finalizada com sucesso!",icon:"success"}).then((e=>{window.location.href="index.html"})),i=[],a(),t())}))}}function c(e){if(!d)return void Swal.fire({title:"Erro!",text:"Você precisa estar autenticado para realizar esta ação!",icon:"error"}).then((()=>{window.location.href=""}));const n=o.find((t=>t.id===e));n&&(i.push(n),a(),t(),Swal.fire({title:"Carrinho",text:"Produto adicionado ao carrinho com sucesso!",icon:"success"}).then((()=>{window.location.href=""})))}function s(){const e=document.getElementById("products-grid-adm");e&&o.forEach((t=>{const n=document.createElement("a");n.onclick=()=>{l(t.id)},n.className="product-item",n.id=t.id,n.innerHTML=`<div class="delete-product">\n                                        <p>Excluir</p>\n                                        </div>\n                                        <div class="photo">\n                                            <img src="${t.imagem}" alt="${t.nome}">\n                                        </div>\n                                        <div class="info">\n                                            <div class="product-name">${t.nome}</div>\n                                            <div class="product-price">R$${t.preco.toFixed(2)}</div>\n                                    </div>`,e.appendChild(n)}))}function l(e){const n=o.findIndex((t=>t.id===e));-1!==n&&(o.splice(n,1),r(),s(),t(),Swal.fire({title:"Produto removido!",text:"O produto selecionado foi removido com sucesso!",icon:"success"}).then((e=>{window.location.href=""})))}0===o.length&&n("noproducts")?n("noproducts").classList.remove("escondido"):n("noproducts")&&n("noproducts").classList.add("escondido"),(n("addProduct")&&!d||n("addProduct")&&"admin"!==d.role)&&Swal.fire({title:"Opa...",text:"Você não tem permissão pra entrar aqui!",icon:"error"}).then((()=>{window.location.href="index.html"})),d?(n("cartlist")&&n("cartlist").classList.remove("escondido"),n("liCart")&&n("liCart").classList.remove("escondido"),n("username")&&n("password")&&Swal.fire({title:"Opa...",text:"Você já está autenticado! Saia para entrar novamente.",icon:"error"}).then((()=>{window.location.href="index.html"})),n("nocart")&&0===i.length&&(n("nocart").classList.remove("escondido"),n("cartlist").classList.add("escondido")),document.getElementById("indexLoginButton")&&document.getElementById("indexLoginButton").classList.add("escondido"),document.getElementById("usernameIndex")&&document.getElementById("usernameIndex").classList.remove("escondido"),document.getElementById("exitButton")&&document.getElementById("exitButton").classList.remove("escondido"),document.getElementById("usernameIndex")&&(document.getElementById("usernameIndex").innerText=d.username),"admin"===d.role&&(n("leftsideNavBar").innerHTML+='<li><a href="admin.html">Admin</a></li>')):(n("liCart")&&n("liCart").classList.add("escondido"),n("nocart")&&Swal.fire({title:"Opa...",text:"Você não está em sua conta, entre e tente novamente!",icon:"error"}).then((()=>{window.location.href="login.html"})),n("leftsideNavBar")&&(n("leftsideNavBar").innerHTML='<li><a href="index.html">Início</a></li>\n                                                <li><a href="produtos.html">Produtos</a></li>\n                                                <li><a href="carrinho.html">Carrinho</a></li>'),n("indexLoginButton")&&n("indexLoginButton").classList.remove("escondido"),document.getElementById("indexLoginButton")&&document.getElementById("usernameIndex").classList.add("escondido")),document.getElementById("exitButton")?.addEventListener("click",(function(){d=null,localStorage.setItem("carrinho",null),localStorage.setItem("loggedUser",null),document.getElementById("usernameIndex")&&document.getElementById("usernameIndex").classList.add("escondido"),document.getElementById("exitButton")&&document.getElementById("exitButton").classList.add("escondido"),document.getElementById("indexLoginButton")&&document.getElementById("indexLoginButton").classList.remove("escondido")})),document.getElementById("loginButton")?.addEventListener("click",(function(){const n=document.getElementById("username").value,o=document.getElementById("password").value,i=e.find((e=>e.username.toLowerCase()===n.toLowerCase()&&e.password===o));i?(d=i,t(),d&&"admin"===d.role&&s(),Swal.fire({title:"Bem-vindo.",text:`Obrigado por acessar ${i.username}! Boas compras`,icon:"success"}).then((()=>{window.location.href="index.html"}))):Swal.fire({title:"Erro!",text:"Login ou senha inválidos.",icon:"error"})})),document.getElementById("addProduct")?.addEventListener("click",(function(){let e=function(){let e=[];return n("nameProduct")&&""===n("nameProduct").value&&e.push("nome"),n("priceProduct")&&""===n("priceProduct").value&&e.push("preço"),n("productPhotoLink")&&""===n("productPhotoLink").value&&e.push("link da foto"),e}(),i="";if(e.forEach((e=>{i+=`${e}, `})),e.length>0)return void Swal.fire({title:"Campos inválidos!",text:`Por favor, verifique os seguintes campos: ${i}`,icon:"error"}).then((e=>{window.location.href=""}));const d=document.getElementById("nameProduct").value,a=parseFloat(document.getElementById("priceProduct").value),c=document.getElementById("productPhotoLink").value,l=o.length?o[o.length-1].id+1:1;o.push({id:l,nome:d,preco:a,imagem:c}),r(),t(),s(),Swal.fire({title:"Produto adicionado ao carrinho!",text:"O produto adicionado ao carrinho com sucesso!",icon:"success"}).then((e=>{window.location.href=""}))})),window.adicionarAoCarrinho=c,window.removerProduto=l,window.removerCarrinho=function(e){const n=i.findIndex((t=>t.id===e));-1!==n&&(i.splice(n,1),a(),t(),Swal.fire({title:"Produto removido!",text:"O produto selecionado foi removido com sucesso!",icon:"success"}).then((e=>{window.location.href=""})))},r(),a(),d&&"admin"===d.role&&s()}));